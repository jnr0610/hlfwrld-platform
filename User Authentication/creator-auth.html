<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Authentication - Hlfwrld</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            width: 100%;
            max-width: 500px;
        }

        .auth-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }

        .auth-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .auth-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }

        .auth-tabs {
            display: flex;
            background: #f8fafc;
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            background: white;
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: 600;
        }

        .auth-tab:hover {
            background: #f1f5f9;
        }

        .auth-content {
            padding: 2rem;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-input.error {
            border-color: #ef4444;
        }

        .form-error {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .form-help {
            color: #6b7280;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .form-button {
            width: 100%;
            padding: 0.75rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .form-button:hover {
            transform: translateY(-2px);
        }

        .form-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .handle-preview {
            background: #f3f4f6;
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            color: #374151;
            margin-top: 0.25rem;
        }

        .password-strength {
            margin-top: 0.5rem;
        }

        .strength-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .strength-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .strength-weak { background: #ef4444; }
        .strength-medium { background: #f59e0b; }
        .strength-strong { background: #10b981; }

        .strength-text {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 1rem;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .footer {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #e5e7eb;
            text-align: center;
        }

        .copyright {
            color: #9ca3af;
            font-size: 0.9rem;
            font-weight: 300;
        }

        @media (max-width: 768px) {
            .auth-title {
                font-size: 2.5rem;
            }

            .auth-subtitle {
                font-size: 1.1rem;
            }

            .auth-container {
                margin: 10px;
                max-width: 100%;
            }

            .auth-content {
                padding: 1.5rem;
            }
        }

        .terms-container {
            margin-top: 1rem;
        }

        .terms-label {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .terms-label input[type="checkbox"] {
            margin-top: 0.2rem;
            cursor: pointer;
        }

        .terms-label a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }

        .terms-label a:hover {
            text-decoration: underline;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .close:hover {
            color: #333;
        }

        .terms-content {
            margin-top: 1rem;
        }

        .terms-content h2 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .terms-content h3 {
            color: #555;
            margin: 1.5rem 0 0.5rem 0;
            font-size: 1.2rem;
        }

        .terms-content p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .terms-content ul {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        .terms-content li {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="auth-container">
        <div class="auth-header">
            <h1 class="auth-title">Hlfwrld</h1>
            <p class="auth-subtitle">Join our platform and start monetizing your beauty services</p>
        </div>

        <div class="auth-tabs">
            <div class="auth-tab active" onclick="switchTab('login')">Login</div>
            <div class="auth-tab" onclick="switchTab('signup')">Sign Up</div>
        </div>

        <div class="auth-content">
            <!-- Login Form -->
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label class="form-label">Username or Email</label>
                    <input type="text" class="form-input" id="loginIdentifier" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>

                <button type="submit" class="form-button">Login</button>
            </form>

            <!-- Signup Form -->
            <form class="auth-form" id="signupForm">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" id="signupName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" id="signupEmail" required placeholder="your.email@example.com">
                    <div class="form-help">Enter a valid email address</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Phone Number *</label>
                    <input type="tel" class="form-input" id="signupPhone" required placeholder="(555) 123-4567">
                    <div class="form-help">Enter a valid US phone number</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Zip Code *</label>
                    <input type="text" class="form-input" id="signupZipCode" required maxlength="5" placeholder="12345">
                    <div class="form-help">Enter a 5-digit US zip code</div>
                </div>

                <div class="form-group">
                    <label class="form-label">State *</label>
                    <select class="form-input" id="signupState" required>
                        <option value="">Select your state</option>
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Instagram Handle</label>
                    <input type="text" class="form-input" id="signupInstagram" placeholder="@username">
                </div>

                <div class="form-group">
                    <label class="form-label">Username *</label>
                    <input type="text" class="form-input" id="signupUsername" required>
                    <div class="form-help">Must be unique, 3-20 characters, no spaces</div>
                    <div class="handle-preview" id="handlePreview"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">Password *</label>
                    <input type="password" class="form-input" id="signupPassword" required>
                    <div class="password-strength">
                        <div class="strength-bar">
                            <div class="strength-fill" id="strengthFill"></div>
                        </div>
                        <div class="strength-text" id="strengthText">Password strength</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Confirm Password *</label>
                    <input type="password" class="form-input" id="signupConfirmPassword" required>
                </div>

                <div class="form-group">
                    <div class="terms-container">
                        <label class="terms-label">
                            <input type="checkbox" id="agreementAccepted" name="agreementAccepted" required>
                            <span class="checkmark"></span>
                            I agree to the <a href="#" onclick="showTermsModal()">Terms of Service and Creator Agreement</a> *
                        </label>
                    </div>
                </div>

                <button type="submit" class="form-button">Create Account</button>
            </form>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Processing...</p>
            </div>

            <div class="success-message" id="successMessage"></div>
            <div class="error-message" id="errorMessage"></div>

            <div class="footer">
                <p class="copyright">© 2025 Hlfwrld. All rights reserved.</p>
                <a href="../Main Pages/index.html" style="color: #667eea; text-decoration: none; font-weight: 600; font-size: 0.9rem; margin-top: 1rem; display: inline-block;">← Back to Home</a>
            </div>
        </div>
    </div>

    <!-- Terms of Service Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTermsModal()">&times;</span>
            <div class="terms-content">
                <h2>Terms of Service and Creator Agreement</h2>
                
                <p><strong>Last updated:</strong> January 2024</p>
                
                <h3>1. Acceptance of Terms</h3>
                <p>By creating a creator account on Hlfwrld, you agree to be bound by these Terms of Service and Creator Agreement. If you do not agree to these terms, please do not use our platform.</p>
                
                <h3>2. Platform Overview</h3>
                <p>Hlfwrld is a beauty service booking platform that connects beauty influencers with salons and their clients. The platform facilitates appointment bookings, payment processing, and commission distribution to creators.</p>
                
                <h3>3. Creator Responsibilities</h3>
                <ul>
                    <li>Provide accurate and authentic personal information</li>
                    <li>Create genuine, high-quality content and services</li>
                    <li>Maintain professional standards and ethical behavior</li>
                    <li>Comply with all applicable laws and regulations</li>
                    <li>Respect intellectual property rights</li>
                    <li>Engage with your audience in a positive manner</li>
                </ul>
                
                <h3>4. Commission Structure</h3>
                <p>For each confirmed booking made through your profile:</p>
                <ul>
                    <li><strong>Your Commission:</strong> 15% of the service fee</li>
                    <li><strong>Platform Commission:</strong> 20% of the service fee</li>
                    <li><strong>Salon Receives:</strong> 65% of the service fee</li>
                </ul>
                
                <h3>5. Payment Processing</h3>
                <p>All commissions are processed through Stripe Connect. You must have a valid Stripe account to receive payments. Commissions are automatically calculated and transferred after each confirmed booking.</p>
                
                <h3>6. Content and Services</h3>
                <ul>
                    <li>You are responsible for all content you create and share</li>
                    <li>Services must be accurately described and priced</li>
                    <li>You must have the necessary qualifications for services offered</li>
                    <li>Content must not violate any laws or platform policies</li>
                </ul>
                
                <h3>7. Profile and Digital Shop</h3>
                <p>You are responsible for maintaining your profile and digital shop. This includes:</p>
                <ul>
                    <li>Keeping service information up-to-date</li>
                    <li>Responding to client inquiries promptly</li>
                    <li>Ensuring your profile accurately represents your expertise</li>
                    <li>Maintaining professional presentation standards</li>
                </ul>
                
                <h3>8. Client Relationships</h3>
                <p>While you can promote services and direct clients to salons, you are not responsible for the actual service delivery. The salon is responsible for providing the booked services to clients.</p>
                
                <h3>9. Data and Privacy</h3>
                <p>We collect and process personal data in accordance with our Privacy Policy. By using the platform, you consent to the collection and use of your information as described in our Privacy Policy.</p>
                
                <h3>10. Prohibited Activities</h3>
                <ul>
                    <li>Providing false or misleading information</li>
                    <li>Creating fake reviews or testimonials</li>
                    <li>Engaging in fraudulent activities</li>
                    <li>Violating any applicable laws or regulations</li>
                    <li>Attempting to circumvent commission payments</li>
                    <li>Harassing or abusing other users</li>
                    <li>Sharing inappropriate or offensive content</li>
                </ul>
                
                <h3>11. Termination</h3>
                <p>We reserve the right to terminate or suspend creator accounts for violations of these terms. Creators may also terminate their accounts at any time by contacting support.</p>
                
                <h3>12. Limitation of Liability</h3>
                <p>Hlfwrld is not liable for any damages arising from the use of our platform, including but not limited to lost profits, data loss, or service interruptions.</p>
                
                <h3>13. Changes to Terms</h3>
                <p>We may update these terms from time to time. Continued use of the platform after changes constitutes acceptance of the new terms.</p>
                
                <h3>14. Contact Information</h3>
                <p>For questions about these terms, please contact us at support@hlfwrld.com</p>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000';

        // Terms modal functions
        function showTermsModal() {
            document.getElementById('termsModal').style.display = 'block';
        }

        function closeTermsModal() {
            document.getElementById('termsModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('termsModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Tab switching
        function switchTab(tab) {
            // Update tabs
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Update forms
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            if (tab === 'login') {
                document.getElementById('loginForm').classList.add('active');
            } else {
                document.getElementById('signupForm').classList.add('active');
            }

            // Clear messages
            clearMessages();
        }

        // Handle preview
        document.getElementById('signupUsername').addEventListener('input', function() {
            const username = this.value;
            const preview = document.getElementById('handlePreview');
            
            if (username) {
                preview.textContent = `@${username}`;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
        });

        // Password strength checker
        document.getElementById('signupPassword').addEventListener('input', function() {
            const password = this.value;
            const strengthFill = document.getElementById('strengthFill');
            const strengthText = document.getElementById('strengthText');

            let strength = 0;
            let text = '';

            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            if (strength < 2) {
                strengthFill.className = 'strength-fill strength-weak';
                strengthFill.style.width = '25%';
                text = 'Weak';
            } else if (strength < 4) {
                strengthFill.className = 'strength-fill strength-medium';
                strengthFill.style.width = '50%';
                text = 'Medium';
            } else {
                strengthFill.className = 'strength-fill strength-strong';
                strengthFill.style.width = '100%';
                text = 'Strong';
            }

            strengthText.textContent = text;
        });

        // Login form
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const identifier = document.getElementById('loginIdentifier').value;
            const password = document.getElementById('loginPassword').value;

            if (!identifier || !password) {
                showError('Please fill in all fields');
                return;
            }

            showLoading(true);
            clearMessages();

            try {
                const response = await fetch(`${API_BASE}/creators/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        identifier: identifier,
                        password: password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('Login successful! Redirecting...');
                    localStorage.setItem('creatorToken', data.token);
                    localStorage.setItem('creatorData', JSON.stringify(data.creator));
                    
                    // Redirect to creator's unique digital shop page
                    setTimeout(() => {
                        window.location.href = `../Main Pages/digitalshop.html?creator=${data.creator.username}`;
                    }, 1500);
                } else {
                    showError(data.error || 'Login failed');
                }
            } catch (error) {
                showError('Network error. Please try again.');
            } finally {
                showLoading(false);
            }
        });

        // Signup form
        document.getElementById('signupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;
            const zipCode = document.getElementById('signupZipCode').value;
            const state = document.getElementById('signupState').value;
            const instagram = document.getElementById('signupInstagram').value;
            const username = document.getElementById('signupUsername').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;

            // Validation
            if (!name || !email || !phone || !zipCode || !state || !username || !password || !confirmPassword) {
                showError('Please fill in all required fields');
                return;
            }

            // Validate email format
            if (!validateEmail(email)) {
                showError('Please enter a valid email address');
                return;
            }

            // Validate phone format
            if (!validatePhone(phone)) {
                showError('Please enter a valid 10-digit phone number');
                return;
            }

            // Validate zip code format
            if (!validateZipCode(zipCode)) {
                showError('Please enter a valid 5-digit zip code');
                return;
            }

            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }

            if (password.length < 8) {
                showError('Password must be at least 8 characters long');
                return;
            }

            if (username.length < 3 || username.length > 20) {
                showError('Username must be between 3 and 20 characters');
                return;
            }

            if (!/^[a-zA-Z0-9_]+$/.test(username)) {
                showError('Username can only contain letters, numbers, and underscores');
                return;
            }

            // Check if terms are accepted
            const agreementAccepted = document.getElementById('agreementAccepted').checked;
            if (!agreementAccepted) {
                showError('You must accept the Terms of Service and Creator Agreement to continue');
                return;
            }

            showLoading(true);
            clearMessages();

            try {
                const response = await fetch(`${API_BASE}/creators/signup`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        phone: phone,
                        zipCode: zipCode,
                        state: state,
                        instagram: instagram,
                        username: username,
                        password: password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('Account created successfully! Redirecting to your digital shop...');
                    // Store creator data and redirect to their digital shop
                    setTimeout(() => {
                        window.location.href = `../Main Pages/digitalshop.html?creator=${username}`;
                    }, 2000);
                } else {
                    showError(data.error || 'Signup failed');
                }
            } catch (error) {
                showError('Network error. Please try again.');
            } finally {
                showLoading(false);
            }
        });

        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        function showSuccess(message) {
            const success = document.getElementById('successMessage');
            success.textContent = message;
            success.style.display = 'block';
        }

        function showError(message) {
            const error = document.getElementById('errorMessage');
            error.textContent = message;
            error.style.display = 'block';
        }

        // Input validation and auto-correction functions
        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function validatePhone(phone) {
            // Remove all non-digits
            const digits = phone.replace(/\D/g, '');
            return digits.length === 10;
        }

        function formatPhone(phone) {
            // Remove all non-digits
            const digits = phone.replace(/\D/g, '');
            
            // If we have 10 digits, format as (XXX) XXX-XXXX
            if (digits.length === 10) {
                return `(${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6)}`;
            }
            
            // If we have 7 digits, format as XXX-XXXX
            if (digits.length === 7) {
                return `${digits.slice(0, 3)}-${digits.slice(3)}`;
            }
            
            // Return as-is if not enough digits
            return phone;
        }

        function validateZipCode(zipCode) {
            // Remove all non-digits
            const digits = zipCode.replace(/\D/g, '');
            return digits.length === 5;
        }

        function formatZipCode(zipCode) {
            // Remove all non-digits and take first 5
            const digits = zipCode.replace(/\D/g, '').slice(0, 5);
            return digits;
        }

        // Add event listeners for real-time validation
        document.addEventListener('DOMContentLoaded', function() {
            const emailInput = document.getElementById('signupEmail');
            const phoneInput = document.getElementById('signupPhone');
            const zipCodeInput = document.getElementById('signupZipCode');

            // Email validation
            emailInput.addEventListener('blur', function() {
                const email = this.value.trim();
                if (email && !validateEmail(email)) {
                    this.classList.add('error');
                    showFieldError(this, 'Please enter a valid email address');
                } else {
                    this.classList.remove('error');
                    clearFieldError(this);
                }
            });

            // Phone validation and formatting
            phoneInput.addEventListener('input', function() {
                const formatted = formatPhone(this.value);
                if (this.value !== formatted) {
                    this.value = formatted;
                }
            });

            phoneInput.addEventListener('blur', function() {
                const phone = this.value;
                if (phone && !validatePhone(phone)) {
                    this.classList.add('error');
                    showFieldError(this, 'Please enter a valid 10-digit phone number');
                } else {
                    this.classList.remove('error');
                    clearFieldError(this);
                }
            });

            // Zip code validation and formatting
            zipCodeInput.addEventListener('input', function() {
                const formatted = formatZipCode(this.value);
                if (this.value !== formatted) {
                    this.value = formatted;
                }
            });

            zipCodeInput.addEventListener('blur', function() {
                const zipCode = this.value;
                if (zipCode && !validateZipCode(zipCode)) {
                    this.classList.add('error');
                    showFieldError(this, 'Please enter a valid 5-digit zip code');
                } else {
                    this.classList.remove('error');
                    clearFieldError(this);
                }
            });
        });

        function showFieldError(input, message) {
            // Remove existing error
            clearFieldError(input);
            
            // Add error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'form-error';
            errorDiv.textContent = message;
            errorDiv.style.color = '#ef4444';
            errorDiv.style.fontSize = '0.875rem';
            errorDiv.style.marginTop = '0.25rem';
            
            input.parentNode.appendChild(errorDiv);
        }

        function clearFieldError(input) {
            const existingError = input.parentNode.querySelector('.form-error');
            if (existingError) {
                existingError.remove();
            }
        }

        function clearMessages() {
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
        }

        // Initialize with correct tab based on URL parameter
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const defaultTab = urlParams.get('tab') || 'signup';
            switchTab(defaultTab);
        });
    </script>
</body>
</html> 