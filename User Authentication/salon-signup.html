<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salon Sign Up - Hlfwrld</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .signup-container {
      max-width: 500px;
      width: 100%;
      margin: 0 auto;
      padding: 2rem;
    }

    .signup-card {
      background: white;
      border-radius: 16px;
      padding: 3rem 2rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      position: relative;
      overflow: hidden;
    }

    .signup-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .signup-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .signup-header h1 {
      font-size: 2rem;
      color: #333;
      margin-bottom: 0.5rem;
    }

    .signup-header p {
      color: #666;
      font-size: 1rem;
    }

    .info-box {
      background: #e8f4fd;
      border: 1px solid #bee5eb;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .info-box h3 {
      color: #0c5460;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }

    .info-box p {
      color: #0c5460;
      font-size: 0.9rem;
      margin-bottom: 0;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #555;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .code-input {
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      letter-spacing: 0.5rem;
    }

    .submit-btn {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 14px 28px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      margin-top: 1rem;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .login-link {
      text-align: center;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid #e9ecef;
    }

    .login-link a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .login-link a:hover {
      text-decoration: underline;
    }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: #6c757d;
      color: white;
      text-decoration: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      transition: background 0.2s ease;
      margin-top: 1rem;
    }

    .back-btn:hover {
      background: #5a6268;
    }

    .back-btn::before {
      content: "‚Üê";
      font-size: 1.2rem;
    }

    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      display: none;
    }

    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      display: none;
    }

    .terms-container {
      margin-top: 1rem;
    }

    .terms-label {
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      cursor: pointer;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .terms-label input[type="checkbox"] {
      margin-top: 0.2rem;
      cursor: pointer;
    }

    .terms-label a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .terms-label a:hover {
      text-decoration: underline;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }

    .close {
      position: absolute;
      right: 1rem;
      top: 1rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
    }

    .close:hover {
      color: #333;
    }

    .terms-content {
      margin-top: 1rem;
    }

    .terms-content h2 {
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }

    .terms-content h3 {
      color: #555;
      margin: 1.5rem 0 0.5rem 0;
      font-size: 1.2rem;
    }

    .terms-content p {
      margin-bottom: 1rem;
      line-height: 1.6;
    }

    .terms-content ul {
      margin-bottom: 1rem;
      padding-left: 1.5rem;
    }

    .terms-content li {
      margin-bottom: 0.5rem;
    }

    @media (max-width: 768px) {
      .signup-container {
        padding: 1rem;
      }
      
      .signup-card {
        padding: 2rem 1.5rem;
      }
      
      .signup-header h1 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="signup-container">
    <div class="signup-card">
      <div class="signup-header">
        <h1>Salon Sign Up</h1>
        <p>Create your salon account to connect with beauty influencers</p>
      </div>

      <div class="info-box">
        <h3>üîë 4-Digit Code Required</h3>
        <p>You need a 4-digit code from a verified influencer to complete your registration. 
           The code must match an influencer's code and your salon state must match their state.</p>
      </div>

      <div class="error-message" id="errorMessage">
        Error message will appear here
      </div>

      <div class="success-message" id="successMessage">
        Account created successfully! Redirecting to login...
      </div>

      <form id="salonSignupForm">
        <div class="form-group">
          <label for="salonName">Salon Name *</label>
          <input type="text" id="salonName" name="salonName" required>
        </div>

        <div class="form-group">
          <label for="ownerName">Owner Name *</label>
          <input type="text" id="ownerName" name="ownerName" required>
        </div>

        <div class="form-group">
          <label for="email">Email Address *</label>
          <input type="email" id="email" name="email" required>
        </div>

        <div class="form-group">
          <label for="phone">Phone Number *</label>
          <input type="tel" id="phone" name="phone" required>
        </div>

        <div class="form-group">
          <label for="address">Street Address *</label>
          <input type="text" id="address" name="address" required>
        </div>

        <div class="form-group">
          <label for="city">City *</label>
          <input type="text" id="city" name="city" required>
        </div>

        <div class="form-group">
          <label for="state">State *</label>
          <select id="state" name="state" required>
            <option value="">Select State</option>
            <option value="AL">Alabama</option>
            <option value="AK">Alaska</option>
            <option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option>
            <option value="CA">California</option>
            <option value="CO">Colorado</option>
            <option value="CT">Connecticut</option>
            <option value="DE">Delaware</option>
            <option value="FL">Florida</option>
            <option value="GA">Georgia</option>
            <option value="HI">Hawaii</option>
            <option value="ID">Idaho</option>
            <option value="IL">Illinois</option>
            <option value="IN">Indiana</option>
            <option value="IA">Iowa</option>
            <option value="KS">Kansas</option>
            <option value="KY">Kentucky</option>
            <option value="LA">Louisiana</option>
            <option value="ME">Maine</option>
            <option value="MD">Maryland</option>
            <option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option>
            <option value="MN">Minnesota</option>
            <option value="MS">Mississippi</option>
            <option value="MO">Missouri</option>
            <option value="MT">Montana</option>
            <option value="NE">Nebraska</option>
            <option value="NV">Nevada</option>
            <option value="NH">New Hampshire</option>
            <option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option>
            <option value="NY">New York</option>
            <option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option>
            <option value="OH">Ohio</option>
            <option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option>
            <option value="PA">Pennsylvania</option>
            <option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option>
            <option value="SD">South Dakota</option>
            <option value="TN">Tennessee</option>
            <option value="TX">Texas</option>
            <option value="UT">Utah</option>
            <option value="VT">Vermont</option>
            <option value="VA">Virginia</option>
            <option value="WA">Washington</option>
            <option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option>
            <option value="WY">Wyoming</option>
          </select>
        </div>

        <div class="form-group">
          <label for="zipCode">ZIP Code *</label>
          <input type="text" id="zipCode" name="zipCode" required>
        </div>

        <div class="form-group">
          <label for="influencerCode">4-Digit Influencer Code *</label>
          <input type="text" id="influencerCode" name="influencerCode" 
                 class="code-input" maxlength="4" required 
                 placeholder="0000">
        </div>

        <div class="form-group">
          <label for="password">Password *</label>
          <input type="password" id="password" name="password" required>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password *</label>
          <input type="password" id="confirmPassword" name="confirmPassword" required>
        </div>

        <div class="form-group">
          <div class="terms-container">
            <label class="terms-label">
              <input type="checkbox" id="agreementAccepted" name="agreementAccepted" required>
              <span class="checkmark"></span>
              I agree to the <a href="#" onclick="showTermsModal()">Terms of Service and User Agreement</a> *
            </label>
          </div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">Create Salon Account</button>
      </form>

      <div class="login-link">
        Already have an account? <a href="salon-login.html">Log in here</a>
      </div>

      <div style="text-align: center;">
        <a href="salon-landing.html" class="back-btn">Back to Salon Landing</a>
      </div>
    </div>
  </div>

  <!-- Terms of Service Modal -->
  <div id="termsModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeTermsModal()">&times;</span>
      <div class="terms-content">
        <h2>Terms of Service and User Agreement</h2>
        
        <p><strong>Last updated:</strong> January 2024</p>
        
        <h3>1. Acceptance of Terms</h3>
        <p>By creating a salon account on Hlfwrld, you agree to be bound by these Terms of Service and User Agreement. If you do not agree to these terms, please do not use our platform.</p>
        
        <h3>2. Platform Overview</h3>
        <p>Hlfwrld is a beauty service booking platform that connects salons with beauty influencers and their clients. The platform facilitates appointment bookings, payment processing, and commission distribution.</p>
        
        <h3>3. Salon Responsibilities</h3>
        <ul>
          <li>Provide accurate and up-to-date business information</li>
          <li>Maintain professional standards and quality of service</li>
          <li>Respond to booking requests within 24 hours</li>
          <li>Confirm appointments and manage your schedule</li>
          <li>Process refunds when necessary</li>
          <li>Comply with all applicable laws and regulations</li>
        </ul>
        
        <h3>4. Commission Structure</h3>
        <p>For each confirmed booking:</p>
        <ul>
          <li><strong>Platform Commission:</strong> 20% of the service fee</li>
          <li><strong>Influencer Commission:</strong> 15% of the service fee</li>
          <li><strong>Salon Receives:</strong> 65% of the service fee</li>
        </ul>
        
        <h3>5. Payment Processing</h3>
        <p>All payments are processed through Stripe. Salons will receive their portion of the payment after the appointment is confirmed and completed. Commission deductions are automatic and non-negotiable.</p>
        
        <h3>6. Appointment Management</h3>
        <ul>
          <li>Salons must manually confirm all paid appointments</li>
          <li>If conflicts arise, salons must offer alternative times or process refunds</li>
          <li>Time slots are reserved for 10 minutes during payment processing</li>
          <li>Failed payments automatically release time slots</li>
        </ul>
        
        <h3>7. Cancellation and Refund Policy</h3>
        <p>Salons may cancel appointments and process refunds when necessary. Refunds must be processed within 24 hours of the original booking. The platform will handle the refund through Stripe and notify the client.</p>
        
        <h3>8. Data and Privacy</h3>
        <p>We collect and process personal data in accordance with our Privacy Policy. By using the platform, you consent to the collection and use of your information as described in our Privacy Policy.</p>
        
        <h3>9. Prohibited Activities</h3>
        <ul>
          <li>Providing false or misleading information</li>
          <li>Failing to honor confirmed appointments</li>
          <li>Engaging in fraudulent activities</li>
          <li>Violating any applicable laws or regulations</li>
          <li>Attempting to circumvent commission payments</li>
        </ul>
        
        <h3>10. Termination</h3>
        <p>We reserve the right to terminate or suspend salon accounts for violations of these terms. Salons may also terminate their accounts at any time by contacting support.</p>
        
        <h3>11. Limitation of Liability</h3>
        <p>Hlfwrld is not liable for any damages arising from the use of our platform, including but not limited to lost profits, data loss, or service interruptions.</p>
        
        <h3>12. Changes to Terms</h3>
        <p>We may update these terms from time to time. Continued use of the platform after changes constitutes acceptance of the new terms.</p>
        
        <h3>13. Contact Information</h3>
        <p>For questions about these terms, please contact us at support@hlfwrld.com</p>
      </div>
    </div>
  </div>

  <script>
            const API_BASE = 'https://www.hlfwrld.com';
    const salonSignupForm = document.getElementById('salonSignupForm');
    const errorMessage = document.getElementById('errorMessage');
    const successMessage = document.getElementById('successMessage');
    const submitBtn = document.getElementById('submitBtn');

    // Auto-format phone number
    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('input', (e) => {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length >= 6) {
        value = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
      } else if (value.length >= 3) {
        value = value.replace(/(\d{3})(\d{0,3})/, '($1) $2');
      }
      e.target.value = value;
    });

    // Auto-format ZIP code
    const zipInput = document.getElementById('zipCode');
    zipInput.addEventListener('input', (e) => {
      e.target.value = e.target.value.replace(/\D/g, '').substring(0, 5);
    });

    // Auto-format influencer code
    const codeInput = document.getElementById('influencerCode');
    codeInput.addEventListener('input', (e) => {
      e.target.value = e.target.value.replace(/\D/g, '').substring(0, 4);
    });

    // Email validation
    const emailInput = document.getElementById('email');
    emailInput.addEventListener('blur', () => {
      const email = emailInput.value;
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      
      if (email && !emailRegex.test(email)) {
        emailInput.style.borderColor = '#dc3545';
        emailInput.setCustomValidity('Please enter a valid email address');
      } else {
        emailInput.style.borderColor = '#e1e5e9';
        emailInput.setCustomValidity('');
      }
    });

    // Terms modal functions
    function showTermsModal() {
      document.getElementById('termsModal').style.display = 'block';
    }

    function closeTermsModal() {
      document.getElementById('termsModal').style.display = 'none';
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('termsModal');
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    }

    salonSignupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      console.log('Form submitted!');
      console.log('API_BASE:', API_BASE);
      
      // Hide any existing messages
      errorMessage.style.display = 'none';
      successMessage.style.display = 'none';
      
      // Check if terms are accepted
      const agreementAccepted = document.getElementById('agreementAccepted').checked;
      if (!agreementAccepted) {
        showError('You must accept the Terms of Service and User Agreement to continue');
        return;
      }
      
      // Disable submit button and show loading state
      submitBtn.disabled = true;
      submitBtn.textContent = 'Creating Account...';
      
      const formData = new FormData(salonSignupForm);
      const data = {
        salonName: formData.get('salonName'),
        ownerName: formData.get('ownerName'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        address: formData.get('address'),
        city: formData.get('city'),
        state: formData.get('state'),
        zipCode: formData.get('zipCode'),
        influencerCode: formData.get('influencerCode'),
        password: formData.get('password'),
        confirmPassword: formData.get('confirmPassword'),
        agreementAccepted: agreementAccepted
      };

      // Client-side validation
      if (data.password !== data.confirmPassword) {
        showError('Passwords do not match');
        return;
      }

      if (data.influencerCode.length !== 4) {
        showError('Influencer code must be exactly 4 digits');
        return;
      }

      try {
        console.log('Sending data to API:', data);
        console.log('Full URL:', `${API_BASE}/salon/signup`);
        const response = await fetch(`${API_BASE}/salon/signup`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });

        console.log('Response status:', response.status);
        const result = await response.json();
        console.log('Response result:', result);

        if (response.ok && result.success) {
          console.log('‚úÖ Success! Hybrid tokens received:', { 
            sessionToken: result.sessionToken, 
            jwtToken: result.jwtToken ? result.jwtToken.substring(0, 20) + '...' : 'Not provided' 
          });
          
          // Store both tokens in localStorage
          localStorage.setItem('salonSessionToken', result.sessionToken); // Short-term (24 hours)
          localStorage.setItem('salonJWTToken', result.jwtToken); // Long-term (90 days)
          localStorage.setItem('salonData', JSON.stringify({
            salonId: result.salonId,
            salonName: result.salonName
          }));
          
          showSuccess('Salon account created successfully! Redirecting to dashboard...');
          setTimeout(() => {
            window.location.href = '../Dashboards/salon-dashboard.html?sessionToken=' + result.sessionToken;
          }, 2000);
        } else {
          console.log('‚ùå Server error:', result);
          showError(result.error || 'Failed to create salon account');
        }
        
      } catch (error) {
        console.error('‚ùå Error creating salon account:', error);
        console.error('Error details:', error.message);
        showError('Network error. Please check your connection and try again.');
      } finally {
        // Re-enable submit button
        submitBtn.disabled = false;
        submitBtn.textContent = 'Create Salon Account';
      }
    });

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.display = 'block';
      errorMessage.scrollIntoView({ behavior: 'smooth' });
    }

    function showSuccess(message) {
      successMessage.textContent = message;
      successMessage.style.display = 'block';
      successMessage.scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html> 